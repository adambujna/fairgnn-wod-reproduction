{'model': 'fairkd', 'task': 'train', 'dataset': 'pokec_z', 'dgl_data': False, 'device': 'cpu', 'seed': 0, 'epochs': 200, 'print_every': 1, 'save_every': -1, 'lr': 0.01, 'weight_decay': 0.0005, 'hidden': 64, 'patience': 20, 'warmup': 50, 'dropout': 0.0, 'kd_temp': 4, 'kd_lambda': 0.5, 'hidden_vgae': 64, 'latent_size': 32, 'hgr_steps_per_epoch': 2, 'lambda_hgr': 0.5, 'hidden_hgr': 64, 'channels': 8, 'lambda_dd': 0.1, 'alpha': 0.1, 'beta': 1.0, 'gamma': 5.0, 'adv_steps_per_epoch': 2, 'mask_warmup': 0.4}
--- Starting train FAIRKD on pokec_z ---
Starting FairKD training on pokec_z...
Epoch: 1 | Loss: 0.6539 | Val F1: 0.618739902973175 | Val Acc: 0.4480 | Time: 0.3307s
Epoch: 2 | Loss: 3.4816 | Val F1: 0.0028188865398167725 | Val Acc: 0.4483 | Time: 0.2920s
Epoch: 3 | Loss: 1.0476 | Val F1: 0.7110552763819096 | Val Acc: 0.5517 | Time: 0.2908s
Epoch: 4 | Loss: 0.5076 | Val F1: 0.35568952560424805 | Val Acc: 0.5520 | Time: 0.2908s
Epoch: 5 | Loss: 0.8339 | Val F1: 0.35568952560424805 | Val Acc: 0.5520 | Time: 0.2900s
Epoch: 6 | Loss: 0.7989 | Val F1: 0.35568952560424805 | Val Acc: 0.5520 | Time: 0.2907s
Epoch: 7 | Loss: 0.6301 | Val F1: 0.35568952560424805 | Val Acc: 0.5520 | Time: 0.2916s
Epoch: 8 | Loss: 0.5059 | Val F1: 0.7110552763819096 | Val Acc: 0.5517 | Time: 0.2894s
Epoch: 9 | Loss: 0.4548 | Val F1: 0.6998056095529019 | Val Acc: 0.5786 | Time: 0.2898s
Epoch: 10 | Loss: 0.4296 | Val F1: 0.6813040585495675 | Val Acc: 0.6265 | Time: 0.2905s
Epoch: 11 | Loss: 0.4139 | Val F1: 0.672798019101521 | Val Acc: 0.6394 | Time: 0.2894s
Epoch: 12 | Loss: 0.4035 | Val F1: 0.6757123473541384 | Val Acc: 0.6273 | Time: 0.2916s
Epoch: 13 | Loss: 0.4002 | Val F1: 0.6694560669456067 | Val Acc: 0.6612 | Time: 0.2909s
Epoch: 14 | Loss: 0.4000 | Val F1: 0.6779303062302007 | Val Acc: 0.6433 | Time: 0.2910s
Epoch: 15 | Loss: 0.3932 | Val F1: 0.6727272727272727 | Val Acc: 0.6491 | Time: 0.3066s
Epoch: 16 | Loss: 0.3850 | Val F1: 0.673469387755102 | Val Acc: 0.6507 | Time: 0.4094s
Epoch: 17 | Loss: 0.3807 | Val F1: 0.6827281981676281 | Val Acc: 0.6355 | Time: 0.4051s
Epoch: 18 | Loss: 0.3793 | Val F1: 0.6756052141527001 | Val Acc: 0.6604 | Time: 0.3740s
Epoch: 19 | Loss: 0.3756 | Val F1: 0.682839814484481 | Val Acc: 0.6534 | Time: 0.3273s
Epoch: 20 | Loss: 0.3690 | Val F1: 0.6843739220420835 | Val Acc: 0.6433 | Time: 0.2950s
Epoch: 21 | Loss: 0.3646 | Val F1: 0.6778996865203761 | Val Acc: 0.6795 | Time: 0.2937s
Epoch: 22 | Loss: 0.3598 | Val F1: 0.6870799103808812 | Val Acc: 0.6733 | Time: 0.2960s
Epoch: 23 | Loss: 0.3536 | Val F1: 0.6895266492732016 | Val Acc: 0.6752 | Time: 0.2979s
Epoch: 24 | Loss: 0.3498 | Val F1: 0.6787293928427824 | Val Acc: 0.6885 | Time: 0.2957s
Epoch: 25 | Loss: 0.3460 | Val F1: 0.7025454545454546 | Val Acc: 0.6811 | Time: 0.3237s
Epoch: 26 | Loss: 0.3391 | Val F1: 0.6917352134743439 | Val Acc: 0.6932 | Time: 0.3217s
Epoch: 27 | Loss: 0.3331 | Val F1: 0.7028066128412149 | Val Acc: 0.6986 | Time: 0.2965s
Epoch: 28 | Loss: 0.3295 | Val F1: 0.7172264355362947 | Val Acc: 0.6947 | Time: 0.3268s
Epoch: 29 | Loss: 0.3266 | Val F1: 0.6783187682064087 | Val Acc: 0.6986 | Time: 0.3320s
Epoch: 30 | Loss: 0.3288 | Val F1: 0.7230227345501121 | Val Acc: 0.6628 | Time: 0.3552s
Epoch: 31 | Loss: 0.3412 | Val F1: 0.668936170212766 | Val Acc: 0.6967 | Time: 0.3304s
Epoch: 32 | Loss: 0.3326 | Val F1: 0.6957928802588996 | Val Acc: 0.7068 | Time: 0.3338s
Epoch: 33 | Loss: 0.3183 | Val F1: 0.7251612903225807 | Val Acc: 0.6678 | Time: 0.3512s
Epoch: 34 | Loss: 0.3365 | Val F1: 0.7109190887666929 | Val Acc: 0.7131 | Time: 0.3488s
Epoch: 35 | Loss: 0.3107 | Val F1: 0.675710046629928 | Val Acc: 0.7018 | Time: 0.3437s
Epoch: 36 | Loss: 0.3241 | Val F1: 0.7251798561151079 | Val Acc: 0.7021 | Time: 0.3104s
Epoch: 37 | Loss: 0.3080 | Val F1: 0.7340045469308217 | Val Acc: 0.6807 | Time: 0.3398s
Epoch: 38 | Loss: 0.3179 | Val F1: 0.7074939564867043 | Val Acc: 0.7170 | Time: 0.3066s
Epoch: 39 | Loss: 0.3092 | Val F1: 0.6970069700697007 | Val Acc: 0.7119 | Time: 0.2935s
Epoch: 40 | Loss: 0.3101 | Val F1: 0.7315202231520224 | Val Acc: 0.6998 | Time: 0.2936s
Epoch: 41 | Loss: 0.3065 | Val F1: 0.7263007840342124 | Val Acc: 0.7006 | Time: 0.2948s
Epoch: 42 | Loss: 0.3027 | Val F1: 0.701797385620915 | Val Acc: 0.7154 | Time: 0.2969s
Epoch: 43 | Loss: 0.3056 | Val F1: 0.7133359405553383 | Val Acc: 0.7142 | Time: 0.2964s
Epoch: 44 | Loss: 0.2976 | Val F1: 0.7332878581173261 | Val Acc: 0.6951 | Time: 0.3126s
Epoch: 45 | Loss: 0.3045 | Val F1: 0.7143962848297214 | Val Acc: 0.7123 | Time: 0.2946s
Epoch: 46 | Loss: 0.2937 | Val F1: 0.7047850770478508 | Val Acc: 0.7162 | Time: 0.2995s
Epoch: 47 | Loss: 0.2972 | Val F1: 0.7330508474576272 | Val Acc: 0.7053 | Time: 0.3044s
Epoch: 48 | Loss: 0.2944 | Val F1: 0.725925925925926 | Val Acc: 0.7115 | Time: 0.3343s
Epoch: 49 | Loss: 0.2894 | Val F1: 0.7059301380991064 | Val Acc: 0.7177 | Time: 0.3403s
Epoch: 50 | Loss: 0.2934 | Val F1: 0.7307692307692307 | Val Acc: 0.7107 | Time: 0.3197s
Epoch: 51 | Loss: 0.2884 | Val F1: 0.7283493708364175 | Val Acc: 0.7138 | Time: 0.2959s
Epoch: 52 | Loss: 0.2859 | Val F1: 0.708502024291498 | Val Acc: 0.7193 | Time: 0.2961s
Epoch: 53 | Loss: 0.2890 | Val F1: 0.7305475504322767 | Val Acc: 0.7084 | Time: 0.3016s
Epoch: 54 | Loss: 0.2860 | Val F1: 0.7243491577335375 | Val Acc: 0.7193 | Time: 0.3059s
Epoch: 55 | Loss: 0.2821 | Val F1: 0.7197477335435554 | Val Acc: 0.7228 | Time: 0.3315s
Epoch: 56 | Loss: 0.2829 | Val F1: 0.7313801623720437 | Val Acc: 0.7033 | Time: 0.2987s
Epoch: 57 | Loss: 0.2847 | Val F1: 0.7112903225806452 | Val Acc: 0.7209 | Time: 0.3045s
Epoch: 58 | Loss: 0.2841 | Val F1: 0.7333092746300974 | Val Acc: 0.7119 | Time: 0.2984s
Epoch: 59 | Loss: 0.2807 | Val F1: 0.725520431765613 | Val Acc: 0.7224 | Time: 0.2969s
Epoch: 60 | Loss: 0.2781 | Val F1: 0.727760736196319 | Val Acc: 0.7232 | Time: 0.3025s
Epoch: 61 | Loss: 0.2773 | Val F1: 0.7353801169590644 | Val Acc: 0.7177 | Time: 0.3032s
Epoch: 62 | Loss: 0.2781 | Val F1: 0.7192276749798874 | Val Acc: 0.7279 | Time: 0.2931s
Epoch: 63 | Loss: 0.2808 | Val F1: 0.7354138398914518 | Val Acc: 0.6959 | Time: 0.2914s
Epoch: 64 | Loss: 0.2870 | Val F1: 0.6878216123499142 | Val Acc: 0.7162 | Time: 0.3187s
Epoch: 65 | Loss: 0.3010 | Val F1: 0.7340258105130626 | Val Acc: 0.6706 | Time: 0.2988s
Epoch: 66 | Loss: 0.3066 | Val F1: 0.6943620178041543 | Val Acc: 0.7189 | Time: 0.3661s
Epoch: 67 | Loss: 0.2932 | Val F1: 0.7307110438729199 | Val Acc: 0.7224 | Time: 0.3772s
Epoch: 68 | Loss: 0.2743 | Val F1: 0.7344328508919555 | Val Acc: 0.6924 | Time: 0.3595s
Epoch: 69 | Loss: 0.2873 | Val F1: 0.6943972835314092 | Val Acc: 0.7193 | Time: 0.3074s
Epoch: 70 | Loss: 0.2933 | Val F1: 0.7345264727815063 | Val Acc: 0.7224 | Time: 0.3818s
Epoch: 71 | Loss: 0.2744 | Val F1: 0.7347079037800688 | Val Acc: 0.6990 | Time: 0.3313s
Epoch: 72 | Loss: 0.2844 | Val F1: 0.7035175879396985 | Val Acc: 0.7240 | Time: 0.3080s
Epoch: 73 | Loss: 0.2866 | Val F1: 0.7229755908562573 | Val Acc: 0.7212 | Time: 0.3176s
Epoch: 74 | Loss: 0.2738 | Val F1: 0.7340389211334927 | Val Acc: 0.6963 | Time: 0.3047s
Epoch: 75 | Loss: 0.2862 | Val F1: 0.71294405879951 | Val Acc: 0.7259 | Time: 0.3206s
Epoch: 76 | Loss: 0.2784 | Val F1: 0.7158999192897498 | Val Acc: 0.7255 | Time: 0.3099s
Epoch: 77 | Loss: 0.2767 | Val F1: 0.735632183908046 | Val Acc: 0.7041 | Time: 0.2929s
Epoch: 78 | Loss: 0.2822 | Val F1: 0.7250965250965251 | Val Acc: 0.7224 | Time: 0.3035s
Epoch: 79 | Loss: 0.2731 | Val F1: 0.7067545304777595 | Val Acc: 0.7224 | Time: 0.3003s
Epoch: 80 | Loss: 0.2794 | Val F1: 0.7376146788990826 | Val Acc: 0.7212 | Time: 0.2991s
Epoch: 81 | Loss: 0.2748 | Val F1: 0.7360294117647059 | Val Acc: 0.7201 | Time: 0.3005s
Epoch: 82 | Loss: 0.2745 | Val F1: 0.7124744376278118 | Val Acc: 0.7259 | Time: 0.3288s
Epoch: 83 | Loss: 0.2772 | Val F1: 0.7287418237783763 | Val Acc: 0.7251 | Time: 0.3845s
Epoch: 84 | Loss: 0.2720 | Val F1: 0.7364620938628159 | Val Acc: 0.7154 | Time: 0.3601s
Epoch: 85 | Loss: 0.2761 | Val F1: 0.7181745396317054 | Val Acc: 0.7255 | Time: 0.3235s
Epoch: 86 | Loss: 0.2740 | Val F1: 0.7221570926143025 | Val Acc: 0.7228 | Time: 0.3099s
Epoch: 87 | Loss: 0.2719 | Val F1: 0.7361211247296323 | Val Acc: 0.7146 | Time: 0.3656s
Epoch: 88 | Loss: 0.2754 | Val F1: 0.7223101265822784 | Val Acc: 0.7263 | Time: 0.3759s
Epoch: 89 | Loss: 0.2723 | Val F1: 0.7223529411764706 | Val Acc: 0.7240 | Time: 0.3214s
Epoch: 90 | Loss: 0.2715 | Val F1: 0.7366896052155016 | Val Acc: 0.7166 | Time: 0.3015s
Epoch: 91 | Loss: 0.2741 | Val F1: 0.7224634820371102 | Val Acc: 0.7259 | Time: 0.3052s
Epoch: 92 | Loss: 0.2717 | Val F1: 0.7254368932038835 | Val Acc: 0.7244 | Time: 0.2996s
Epoch: 93 | Loss: 0.2706 | Val F1: 0.7346491228070176 | Val Acc: 0.7170 | Time: 0.3045s
Epoch: 94 | Loss: 0.2729 | Val F1: 0.7235901509134234 | Val Acc: 0.7287 | Time: 0.3252s
Epoch: 95 | Loss: 0.2719 | Val F1: 0.7298433320596103 | Val Acc: 0.7244 | Time: 0.3022s
Epoch: 96 | Loss: 0.2699 | Val F1: 0.7343923162172147 | Val Acc: 0.7197 | Time: 0.3698s
Epoch: 97 | Loss: 0.2712 | Val F1: 0.7229299363057324 | Val Acc: 0.7287 | Time: 0.3652s
Epoch: 98 | Loss: 0.2721 | Val F1: 0.7354260089686099 | Val Acc: 0.7240 | Time: 0.3578s
Epoch: 99 | Loss: 0.2702 | Val F1: 0.7334593572778828 | Val Acc: 0.7251 | Time: 0.3017s
Epoch: 100 | Loss: 0.2695 | Val F1: 0.7218045112781954 | Val Acc: 0.7259 | Time: 0.2997s
Early stopping at epoch 100
Training Finished. Total Time: 31.7377s

Restoring best model...
--------------------------------------------------
Test Set Results (pokec_z):
     AUC: 0.7763
Accuracy: 0.7019
F1 Score: 0.7138
Fairness Metrics:
  sp: [-0.0825, 0.0825]
  eo: [-0.0618, 0.0663]
--------------------------------------------------
